!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Keyboardist=e()}(this,function(){"use strict";var t=function(t){return!(!t||!t.tagName)&&("BUTTON"===t.tagName||"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName)},e=function(e){return t(e.target||e.nativeEvent.target)},n={ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",ControlLeft:"control",ControlRight:"control"},o=function(t){return"code"in t?!!n[t.code]:16===t.which||17===t.which||18===t.which||91===t.which},i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right"},r=function(t){var e="",n=[];if("code"in t)e=i[t.code]?i[t.code]:t.code;else{var o=t.which;e=String.fromCharCode(o).toLowerCase(),i[o]&&(e=i[o])}return t.altKey&&n.push("Alt"),t.shiftKey&&n.push("Shift"),t.ctrlKey&&n.push("Ctrl"),t.metaKey&&n.push("Meta"),n.push(e),n.join("+")},a=function(t){console.log(":keyboard event:",t)};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"keydown",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("undefined"==typeof window)return!1;var f={},u=null;null===i&&(i=window.document);var c=!t(i);function h(t){if(!(o(t)||c&&e(t))){var n=r(t),i=f[n.toLowerCase()]||[];"function"==typeof u&&u(n,i.length>0,t),i.length&&t.preventDefault();for(var a=!0,h=i.length-1;h>=0&&(i[h]&&(a=i[h](t)),!1!==a);h--);}}function l(){i.addEventListener(n,h)}return l(),{subscribe:function(t,e){return(t=t.toLowerCase()).replace(/\s/,""),void 0===f[t]&&(f[t]=[]),f[t].push(e),{unsubscribe:function(){var n=f[t].indexOf(e);f[t].splice(n,1)}}},setMonitor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u=!0===t?a:t},startListening:l,stopListening:function(){i.removeEventListener(n,h)}}}});
